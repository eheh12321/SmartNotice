# 스마트 마을알림 시스템
엄청난 스마트 마을알림 시스템을 만들어보자
<br>

## 1. 기술 스택
### Spring Boot
- JPA
- thymeleaf
- Spring Security
- (테스트 프레임워크) Mockito + JUnit5
### MySQL
### AWS EC2
### 외부 API
- Google Cloud TTS


### 기타
- 도메인 연결 o
- HTTPS 적용
<br>

## 2. To-Do List
<details>
   <summary> <4월 1주차> - 회원 관리 서비스 구현하기 </summary>
   <br>

    ===== 완료 =====
    1. 마을 주민, 관리자, 마을에 대한 기본적인 CRUD

    2. 마을 관리자 등록 및 관리 기능 구현
        - 중복해서 등록 및 출력되는 문제 해결 필요
        - 마을 관리자를 삭제 시 관리자 계정도 삭제할 것인가?

    3. 마을 주민을 관리자로 등록할 수 있도록 하기
        - 등록 시 마을 주민 정보를 이용해 관리자 계정을 생성함

    4. 입력 폼 데이터 검증 
        - 회원가입 시 아이디, 전화번호 중복 검증은 좀 더 알아보기 (AJAX를 써야하는지?)
        - 프론트 단 검증은 나중에 생각하고 서버 단에서 할 수 있는 오브젝트 에러 넘기기

    5. 보호자와 마을 주민 연결

    6. 마을 추가 시 지역을 selectbox로 선택할 수 있도록 구현하기

    7. 주민 회원가입시 마을 선택할 수 있도록 구현하기

    8. 관제 사이트에 대한 로그인, 로그아웃, 권한 관리 기능 구현
        - 제일 어려웠는데 어떻게 잘 해결이 되었다 :D
        - 관제 사이트, 마을 주민 사이트, 보호자 사이트 총 3개의 Config 이용하도록
        - 권한에 맞는 기능 접근은 차차 하는 것으로

    9. 에러처리 페이지 추가 (403, 404, 500 등)
        - 관리자에서 주민으로 넘어가는거는 정상적으로 되는데 주민에서 관리자로 넘어가면 안됨 (로그인 페이지로 넘기도록 조치함)

    + AWS 배포해서 팀원이랑 공유하기

    ===== 미완료 =====
    1. 검색 기능에 옵션 추가 (마을별, 지역별 검색 등)
        - 동적 쿼리도 공부하기
        - 고급 검색이 굳이 필요한가 싶기는 함. 화면 구상에 따라 필요하면 만들 것
</details>

<br>

<details>
    <summary> <4월 2주차> - 권한 관리, 방송기능 구현 </summary>
    <br>

    ===== 완료 =====
    1. TTS 서버와 연동 -> Google Cloud TTS 사용
        - 1달에 백만자 무료사용

    2. 음성 파일 저장 폴더 체계화 (날짜별 분류..) 
        - /storage/2022/04/12/test.mp3

    3. 방송 목록 조회 기능 구현

    4. 서버에 저장된 방송 불러오기 기능 구현
        - src 내 resources 폴더 안에다 넣으면 동적으로 생성 이후 접근이 안됨. 
        - 외부 디렉토리 (프로젝트 경로)에 storage 디텍토리 만들고 거기 안에다 동적으로 생성 및 접근하도록 함

    5. 문자 방송 기능 구현
        - 방송 타입(일반, 재난) 선택 기능 나중에 추가하기

    6. 부트스트랩 템플릿 적용 및 테스트
        - 정적 파일은 캐싱해 사용하도록 설정 (기간:1달)
    
    7. 방송 삭제 기능 구현
        - 방송 목록에서 삭제할 때 방송 파일도 같이 삭제

    + 단뒤 테스트 작성 및 코드 리팩토링, 주석 달기

</details>

<br>

<details>
    <summary> <4월 3주차> - 방송 기능 구현 (중간고사 기간) </summary>
    <br>

    ===== 완료 =====
    1. 문자 방송 내 재난 방송 기능 추가
        - 방송 목록에서 재난방송은 강조해서 보이도록 함.

    2. 문자 방송 미리듣기 기능 구현

    3. 음성 방송 기능 구현
        - 웹에서 마이크 녹음 만들었으나, HTTPS에서만 동작하는 문제가 있음

    4. 음성 방송 미리듣기 기능 구현

    ===== 미완료 =====
    1. 마을 별 방송 검색 기능 만들기

    2. 오픈 API를 이용한 재난알림 시스템 만들기

</details>

<br>

<details>
    <summary> <4월 4주차> - 방송 기능 구현 </summary>
    <br>

    ===== 완료 =====
    1. 첨부파일(.mp3)을 통한 음성 방송 기능 구현 
    
    2. 음성 방송 페이지 잡다한 오류 수정 및 디자인
       
    3. 무료 도메인 연결, URL에 포트번호 숨기기

    4. SSL 인증서 발급 및 HTTPS 적용
    
    ===== 미완료 =====
    1. 오픈 API를 이용한 재난알림 시스템 만들기

    2. 마을 별 방송 검색 기능 만들기

</details>

<br>

+ 프론트 화면 나오는 대로 적용 후 공유하기
+ 테스트 코드 작성을 생활화...
+ **DTO는 서비스 계층에서 변환하기**
+ **절대 개인정보가 담긴 파일을 Git에 올리지 말것!!!!!**

<br>
   
## 3. 구현된 기능
- 관리자 회원가입, 수정, 조회, 삭제 <br>
- 마을 주민 회원가입, 수정, 조회, 삭제 <br>
- 보호자 회원가입, 수정, 조회, 삭제 <br>
- 마을 등록, 수정, 조회, 삭제, 마을 관리자 등록 <br>
- 로그인, 로그아웃 <br>
- 문자 방송, 음성 방송(녹음을 통해 / 첨부파일을 통해) + 방송 저장 전 미리듣기 <br>
- 방송 조회, 삭제, 다시 듣기
